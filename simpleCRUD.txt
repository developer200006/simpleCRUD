<?php
$con = new MySQLi("localhost", "root","","user");//"DB_SERVER", "DB_USERNAME", "DB_PASSWORD", "DB_NAME"
if ($con->connect_errno > 0) {
    die("ERROR: Could not connect." . $con->connect_error);
}
$message = "";

if (count($_POST)>0) {
    switch ($_POST["operation"]) {
        case "insert":
            $e = $_POST["e"];
            $p = $_POST["p"];
            $sql = "INSERT INTO user (Email,Password) VALUES('$e','$p')";
            $exe = $con->query($sql) or die("ERROR" . $con->error);
            if ($exe) {
                $message = "The User was sucessfully added!";
            } else {
                $message = "The User could not be added!";
            }
            break;

        case "update":
            $ext = $_POST["IdOfUser"];
            $e = $_POST["e" . $ext];
            $p = $_POST["p" . $ext];
            $sql = "UPDATE user  SET Email = '" . $e . "', Password = '" . $p . "' WHERE IdOfUser = $ext";
            $exe = $con->query($sql) or die("ERROR" . $con->error);
            if ($exe) {
                $message = "The User was sucessfully updated!";
            } else {
                $message = "The User could not be updated!";
            }
            break;

        case "delet":
            $sql = "DELETE FROM user WHERE IdOfUser = '" . $_POST["IdOfUser"] . "'";
            $exe = $con->query($sql) or die("ERROR" . $con->error);
            if ($exe) {
                $message = "The User was sucessfully deleted!";
            } else {
                $message = "The User could not be deleted!";
            }
            break;
    }
}
?>
<!exeCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Simple CRUD (PHP+MySQLi)</title>
        <script>
            function insert() {
                document.getElementById("operation").value = "insert";
                document.getElementById("form").submit();
            }
            function update(IdOfUser) {
                document.getElementById("operation").value = "update";
                document.getElementById("IdOfUser").value = IdOfUser;
                document.getElementById("form").submit();
            }
            function delet(IdOfUser) {
                document.getElementById("operation").value = "delet";
                document.getElementById("IdOfUser").value = IdOfUser;
                document.getElementById("form").submit();
            }
        </script>
    </head>
    <body>
        <h4>Simple CRUD (PHP+MySQLi)</h4>
        <form id="form" method="POST" action="CRUD.php">
            <table border=" solid 1px blue">
                <tr><td>IdOfUser</td><td>Email</td><td>Password</td><td></td><td></td></tr>
                <tr><td></td>
                    <td><input type="text" id="e" name="e" required="" ></td>
                    <td><input type="text" id="p" name="p" required="" ></td>
                    <td><input type="button" onclick="insert();" value="Add"></td><td></td></td></tr>
                <input type="hidden" id="operation" name="operation" >
                <input type="hidden" id="IdOfUser" name="IdOfUser">
                <?php
                $sql = " SELECT * FROM user ORDER BY IdOfUser";
                $users = $con->query($sql) or die("Error" . $con->error);
                while ($user = $users->fetch_object()) {
                    echo ('<tr><td>' . $user->IdOfUser . '</td>');
                    echo ('<td><input type="text" id="e' . $user->IdOfUser . '" name= "e' . $user->IdOfUser . '" value="' . $user->Email . '"</td>');
                    echo ('<td><input type="text" id="p' . $user->IdOfUser . '" name= "p' . $user->IdOfUser . '" value="' . $user->Password . '"</td>');
                    echo ('<td><input type="button" value="Delete" onclick="delet(' . $user->IdOfUser . ');"></td>');
                    echo ('<td><input type="button" value="Update" onclick ="update(' . $user->IdOfUser . ');"></td></tr>');
                }
                ?>
            </table>
        </form>
        <br> <?php echo $message; ?>
    </body>
</html>